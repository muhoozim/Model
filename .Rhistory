Suppressed_total_F[t,1,g] <- 0
Suppressed_total_M[t,1,g] <- 0
Suppressed_total_F_young[t,1,g] <- V[t,1,g]+V[t,6,g]+V[t,11,g]
Suppressed_total_M_young[t,1,g] <- V[t,16,g]+V[t,21,g]
On_ART_total[t,1,g] <- 0
On_ART_total_F[t,1,g] <- 0
On_ART_total_M[t,1,g] <- 0
On_ART_total_F_young[t,1,g] <- On_ART[t,1,g]+On_ART[t,6,g]+On_ART[t,11,g]
On_ART_total_M_young[t,1,g] <- On_ART[t,16,g]+On_ART[t,21,g]
Linked_total[t,1,g] <- 0
for(s in c(1:3, 6:8, 11:13)){ # for female subpopulations
N_F_total[t,1,g] <- N_F_total[t,1,g]+N[t,s,g]
NI_F_total[t,1,g] <-  NI_F_total[t,1,g]+NI[t,s,g]
S_F_total[t,1,g] = S_F_total[t,1,g]+S[t,s,g]
On_ART_total_F[t,1,g]=On_ART_total_F[t,1,g]+On_ART[t,s,g]
Suppressed_total_F[t,1,g]=Suppressed_total_F[t,1,g]+V[t,s,g]
Diagnosed_F_total[t,1,g] = Diagnosed_F_total[t,1,g]+Diagnosed[t,s,g]
}
for(s in c(16:18, 21:23)){ # for male subpopulations
N_M_total[t,1,g] <- N_M_total[t,1,g]+N[t,s,g]
NI_M_total[t,1,g] <- NI_M_total[t,1,g]+NI[t,s,g]
S_M_total[t,1,g]=S_M_total[t,1,g]+S[t,s,g]
On_ART_total_M[t,1,g]=On_ART_total_M[t,1,g]+On_ART[t,s,g]
Suppressed_total_M [t,1,g]=Suppressed_total_M[t,1,g]+V[t,s,g]
Diagnosed_M_total[t,1,g] = Diagnosed_M_total[t,1,g]+Diagnosed[t,s,g]
}
for (s in c(1:3, 6:8, 11:13, 16:18, 21:23)){
# Total population
if(is.na(NI[t,s,g])){
NI[t,s,g]=0
}
NI_total[t,1,g]=NI_total[t,1,g]+NI[t,s,g]
N_total[t,1,g]=N_total[t,1,g]+N[t,s,g]
S_total[t,1,g]=S_total[t,1,g]+S[t,s,g]
Diagnosed_total[t,1,g]=Diagnosed_total[t,1,g]+Diagnosed[t,s,g]
New_Diagnosed_total[t,1,g]=New_Diagnosed_total[t,1,g]+New_Diagnosed[t,s,g]
Suppressed_total[t,1,g]=Suppressed_total[t,1,g]+V[t,s,g]
Linked_total[t,1,g]=Linked_total[t,1,g]+Linked[t,s,g]
On_ART_total[t,1,g]=On_ART_total[t,1,g]+On_ART[t,s,g]
}
for (s in c(1:3, 6:8, 11:13, 16:18, 21:23)){
On_ART_grand_total[t,1,g]=On_ART_grand_total[t,1,g]+On_ART[t,s,g]
}
}
}
N_F_total_all <- array(0, dim=c(trial_select,1,generations))
N_M_total_all<- array(0, dim=c(trial_select,1,generations))
N_adult_total_all<- array(0, dim=c(trial_select,1,generations))
S_total_all<- array(0, dim=c(trial_select,1,generations))
S_F_total_all<- array(0, dim=c(trial_select,1,generations))
S_M_total_all<- array(0, dim=c(trial_select,1,generations))
Suppressed_total_all<- array(0, dim=c(trial_select,1,generations))
Suppressed_total_F_all<- array(0, dim=c(trial_select,1,generations))
Suppressed_total_M_all<- array(0, dim=c(trial_select,1,generations))
N_total_all<- array(0, dim=c(trial_select,1,generations))
for (t in (1:trial_select)){
for (g in (1:generations)) {
N_F_total_all[t,1,g] <- 0
N_M_total_all[t,1,g] <- 0
N_total_all[t,1,g] <- 0
S_total_all[t,1,g] <- 0
S_F_total_all[t,1,g] <- 0
S_M_total_all[t,1,g] <- 0
Suppressed_total_all[t,1,g] <- 0
Suppressed_total_F_all[t,1,g] <- 0
Suppressed_total_M_all[t,1,g] <- 0
for(s in c(1:15)){ # for female subpopulations
N_F_total_all[t,1,g] <- N_F_total_all[t,1,g]+N[t,s,g]
S_F_total_all[t,1,g] = S_F_total_all[t,1,g]+S[t,s,g]
Suppressed_total_F_all[t,1,g]=Suppressed_total_F_all[t,1,g]+V[t,s,g]
}
for(s in c(16:20, 21:25)){ # for male subpopulations
N_M_total_all[t,1,g] <- N_M_total_all[t,1,g]+N[t,s,g]
S_M_total_all[t,1,g]=S_M_total_all[t,1,g]+S[t,s,g]
Suppressed_total_M_all [t,1,g]=Suppressed_total_M_all[t,1,g]+V[t,s,g]
}
for (s in c(1:25)){
# Total population
N_total_all[t,1,g]=N_total_all[t,1,g]+N[t,s,g]
S_total_all[t,1,g]=S_total_all[t,1,g]+S[t,s,g]
Suppressed_total_all[t,1,g]=Suppressed_total_all[t,1,g]+V[t,s,g]
}
}
}
# Save the generated parameters
# save.image("Data_trial500.RData")
pd_prev_total_all <- numeric(trial_select)
pd_prev_total_F_all <- numeric(trial_select)
pd_prev_total_M_all <- numeric(trial_select)
pd_vs_total_all <- numeric(trial_select)
pd_vs_total_F_all <- numeric(trial_select)
pd_vs_total_M_all <- numeric(trial_select)
for (t in (1:trial_select)) {
# number on ART
pd_n_art_total[t]<- 0
# percent diagnosed
pd_p_diagnosed[t]<-0
pd_p_diagnosed_F[t]<-0
pd_p_diagnosed_M[t]<-0
pd_p_diagnosed_F_young[t]<-0
pd_p_diagnosed_M_young[t]<-0
# Percent on Treatment
pd_art_p[t] <- 0
pd_art_p_F[t] <- 0
pd_art_p_M[t] <- 0
pd_art_p_F_young[t] <- 0
pd_art_p_M_young[t] <- 0
# Percent virally suppressed
pd_vs_total[t] <- 0
pd_vs_total_F[t] <- 0
pd_vs_total_M[t] <- 0
pd_vs_total_M_young[t] <- 0
pd_vs_total_F_young[t] <- 0
pd_vs_total_all[t] <- 0
pd_vs_total_F_all[t] <- 0
pd_vs_total_M_all[t] <- 0
# Percent virally suppressed on ART
pd_vs_ART_total[t] <- 0
pd_vs_ART_total_F[t] <- 0
pd_vs_ART_total_M[t] <- 0
pd_vs_ART_total_M_young[t] <- 0
pd_vs_ART_total_F_young[t] <- 0
# HIV Prevalence
pd_prev_total[t] <- 0
pd_prev_total_F[t] <- 0
pd_prev_total_M[t] <- 0
pd_prev_total_young[t] <- 0
pd_prev_total_F_young[t] <- 0
pd_prev_total_M_young[t] <- 0
pd_prev_total_all[t] <- 0
pd_prev_total_F_all[t] <- 0
pd_prev_total_M_all[t] <- 0
# HIV Incidence
pd_incidence_total[t] <- 0
pd_incidence_F_total[t] <- 0
pd_incidence_M_total[t] <- 0
pd_incidence_F_young_total[t] <- 0
pd_incidence_M_young_total[t] <- 0
Prevalence_total[t,1,] <- (N_total[t,1,])/(N_total[t,1,]+S_total[t,1,])
Prevalence_total_y[t,] <- Prevalence_total[t,1,][seq(1,length(Prevalence_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence
Target_prev[t,y]<- Target_all[y,"Prevalence"]
if (is.na(Target_prev[t,y])||is.na(Prevalence_total_y[t,y]))
{
pd_prev_total[t] <- pd_prev_total[t]
} else {
pd_prev_total[t] <- pd_prev_total[t]+abs(Prevalence_total_y[t,y]-Target_prev[t,y])/(Target_prev[t,y])
}
}
# HIV prevalence female
Prevalence_F_total[t,1,] <- (N_F_total[t,1,])/(N_F_total[t,1,]+S_F_total[t,1,])
Prevalence_F_total_y[t,] <- Prevalence_F_total[t,1,][seq(1,length(Prevalence_F_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence Female
Target_prev_F[t,y]<- Target_all[y,"Prevalence_F"]
if (is.na(Target_prev_F[t,y])||is.na(Prevalence_F_total_y[t,y]))
{
pd_prev_total_F[t] <- pd_prev_total_F[t]
} else {
pd_prev_total_F[t] <- pd_prev_total_F[t]+abs(Prevalence_F_total_y[t,y]-Target_prev_F[t,y])/(Target_prev_F[t,y])
}
}
# HIV prevalence male
Prevalence_M_total[t,1,] <- (N_M_total[t,1,])/(N_M_total[t,1,]+S_M_total[t,1,])
Prevalence_M_total_y[t,] <- Prevalence_M_total[t,1,][seq(1,length(Prevalence_M_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence male
Target_prev_M[t,y]<- Target_all[y,"Prevalence_M"]
if (is.na(Target_prev_M[t,y])||is.na(Prevalence_M_total_y[t,y]))
{
pd_prev_total_M[t] <- pd_prev_total_M[t]
} else {
pd_prev_total_M[t] <- pd_prev_total_M[t]+abs(Prevalence_M_total_y[t,y]-Target_prev_M[t,y])/(Target_prev_M[t,y])
}
}
# HIV prevalence young female
Prevalence_F_young_total[t,1,] <- (N_F_young_total[t,1,])/(N_F_young_total[t,1,]+S_F_young_total[t,1,])
Prevalence_F_young_total_y[t,] <- Prevalence_F_young_total[t,1,][seq(1,length(Prevalence_F_young_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence F_youngemale
Target_prev_F_young[t,y]<- Target_all[y,"Prevalence_young_F"]
if (is.na(Target_prev_F_young[t,y])||is.na(Prevalence_F_young_total_y[t,y]))
{
pd_prev_total_F_young[t] <- pd_prev_total_F_young[t]
} else {
pd_prev_total_F_young[t] <- pd_prev_total_F_young[t]+abs(Prevalence_F_young_total_y[t,y]-Target_prev_F_young[t,y])/(Target_prev_F_young[t,y])
}
}
# HIV prevalence young male
Prevalence_M_young_total[t,1,] <- (N_M_young_total[t,1,])/(N_M_young_total[t,1,]+S_M_young_total[t,1,])
Prevalence_M_young_total_y[t,] <- Prevalence_M_young_total[t,1,][seq(1,length(Prevalence_M_young_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence male
Target_prev_M_young[t,y]<- Target_all[y,"Prevalence_young_M"]
if (is.na(Target_prev_M_young[t,y])||is.na(Prevalence_M_young_total_y[t,y]))
{
pd_prev_total_M_young[t] <- pd_prev_total_M_young[t]
} else {
pd_prev_total_M_young[t] <- pd_prev_total_M_young[t]+abs(Prevalence_M_young_total_y[t,y]-Target_prev_M_young[t,y])/(Target_prev_M_young[t,y])
}
}
Prevalence_total[t,1,] <- (N_total_all[t,1,])/(N_total_all[t,1,]+S_total_all[t,1,])
Prevalence_total_y[t,] <- Prevalence_total[t,1,][seq(1,length(Prevalence_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence
Target_prev[t,y]<- Target_new[y,"Prevalence"]
if (is.na(Target_prev[t,y])||is.na(Prevalence_total_y[t,y]))
{
pd_prev_total_all[t] <- pd_prev_total_all[t]
} else {
pd_prev_total_all[t] <- pd_prev_total_all[t]+abs(Prevalence_total_y[t,y]-Target_prev[t,y])/(Target_prev[t,y])
}
}
Prevalence_F_total[t,1,] <- (N_F_total_all[t,1,])/(N_F_total_all[t,1,]+S_F_total_all[t,1,])
Prevalence_F_total_y[t,] <- Prevalence_F_total[t,1,][seq(1,length(Prevalence_F_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence Female
Target_prev_F[t,y]<- Target_new[y,"Prevalence_F"]
if (is.na(Target_prev_F[t,y])||is.na(Prevalence_F_total_y[t,y]))
{
pd_prev_total_F_all[t] <- pd_prev_total_F_all[t]
} else {
pd_prev_total_F_all[t] <- pd_prev_total_F_all[t]+abs(Prevalence_F_total_y[t,y]-Target_prev_F[t,y])/(Target_prev_F[t,y])
}
}
Prevalence_M_total[t,1,] <- (N_M_total_all[t,1,])/(N_M_total_all[t,1,]+S_M_total_all[t,1,])
Prevalence_M_total_y[t,] <- Prevalence_M_total[t,1,][seq(1,length(Prevalence_M_total[t,1,]),12)]
for (y in (1:length(Prevalence_total_y[t,]))) {
# Prevalence male
Target_prev_M[t,y]<- Target_new[y,"Prevalence_M"]
if (is.na(Target_prev_M[t,y])||is.na(Prevalence_M_total_y[t,y]))
{
pd_prev_total_M_all[t] <- pd_prev_total_M_all[t]
} else {
pd_prev_total_M_all[t] <- pd_prev_total_M_all[t]+abs(Prevalence_M_total_y[t,y]-Target_prev_M[t,y])/(Target_prev_M[t,y])
}
}
# HIV incidence
NI_total_y[t,] <- rollapply(NI_total[t,1,],12,sum,by=12)
S_total_y[t,] <- S_total[t,1,][seq(1, length(S_total[t,1,]), 12)]
N_total_y[t,] <- N_total[t,1,][seq(1, length(N_total[t,1,]), 12)]
Incidence_total_y[t,] <- NI_total_y[t,]/S_total_y[t,]
for (y in (1:length(Incidence_total_y[t,]))) {
#Incidence
Target_incidence[t,y]<- Target_all[y,"Incidence"]
if (is.na(Target_incidence[t,y])||is.na(Incidence_total_y[t,y]))
{
pd_incidence_total[t] <- pd_incidence_total[t]
} else {
pd_incidence_total[t] <- pd_incidence_total[t]+abs(Incidence_total_y[t,y]-Target_incidence[t,y])/ (Target_incidence[t,y])
}
}
# HIV incidence female
NI_F_total_y[t,] <- rollapply(NI_F_total[t,1,],12,sum,by=12)
S_F_total_y[t,] <- S_F_total[t,1,][seq(1, length(S_F_total[t,1,]), 12)]
N_F_total_y[t,] <- N_F_total[t,1,][seq(1, length(N_F_total[t,1,]), 12)]
Incidence_F_total_y[t,] <- NI_F_total_y[t,]/S_F_total_y[t,]
for (y in (1:length(Incidence_F_total_y[t,]))) {
#Incidence female
Target_incidence_F[t,y]<- Target_all[y,"Incidence_F"]
if (is.na(Target_incidence_F[t,y])||is.na(Incidence_F_total_y[t,y]))
{
pd_incidence_F_total[t] <- pd_incidence_F_total[t]
} else {
pd_incidence_F_total[t] <- pd_incidence_F_total[t]+abs(Incidence_F_total_y[t,y]-Target_incidence_F[t,y])/ (Target_incidence_F[t,y])
}
}
# HIV incidence male
NI_M_total_y[t,] <- rollapply(NI_M_total[t,1,],12,sum,by=12)
S_M_total_y[t,] <- S_M_total[t,1,][seq(1, length(S_M_total[t,1,]), 12)]
N_M_total_y[t,] <- N_M_total[t,1,][seq(1, length(N_M_total[t,1,]), 12)]
Incidence_M_total_y[t,] <- NI_M_total_y[t,]/S_M_total_y[t,]
for (y in (1:length(Incidence_M_total_y[t,]))) {
#Incidence male
Target_incidence_M[t,y]<- Target_all[y,"Incidence_M"]
if (is.na(Target_incidence_M[t,y])||is.na(Incidence_M_total_y[t,y]))
{
pd_incidence_M_total[t] <- pd_incidence_M_total[t]
} else {
pd_incidence_M_total[t] <- pd_incidence_M_total[t]+abs(Incidence_M_total_y[t,y]-Target_incidence_M[t,y])/ (Target_incidence_M[t,y])
}
}
# Number on ART
On_ART_grand_total_y[t,] <- On_ART_grand_total[t,1,][seq(1,length(On_ART_grand_total[t,1,]),12)]
for (y in (1:length(P_suppressed_total_y[t,]))) {
# number on ART
Target_ART[t,y]<- Target_all[y,"N_ART"]
if (is.na(Target_ART[t,y])||is.na(On_ART_grand_total_y[t,y]))
{
pd_n_art_total[t] <- pd_n_art_total[t]
} else {
pd_n_art_total[t] <- pd_n_art_total[t]+abs(On_ART_grand_total_y[t,y]-Target_ART[t,y])/ (Target_ART[t,y])
}
}
# Percent on ART
Diagnosed_total_y[t,] <- Diagnosed_total[t,1,][seq(1, length(Diagnosed_total[t,1,]), 12)]
On_ART_p_y[t,] <- On_ART_total[t,1,][seq(1,length(On_ART_total[t,1,]),12)]/Diagnosed_total_y[t,]*100
for (y in (1:length(P_suppressed_total_y[t,]))) {
# percent on ART
P_Target_ART[t,y]<- Target_new[y,"P_ART_All"]
if (is.na(P_Target_ART[t,y])||is.na(On_ART_p_y[t,y]))
{
pd_art_p[t] <- pd_art_p[t]
} else {
pd_art_p[t] <- pd_art_p[t]+abs(On_ART_p_y[t,y]-P_Target_ART[t,y])/ (P_Target_ART[t,y])
}
}
# Percent on ART female
Diagnosed_F_total_y[t,] <- Diagnosed_F_total[t,1,][seq(1, length(Diagnosed_F_total[t,1,]), 12)]
On_ART_p_F_y[t,] <- On_ART_total_F[t,1,][seq(1,length(On_ART_total_F[t,1,]),12)]/Diagnosed_F_total_y[t,]*100
for (y in (1:length(P_suppressed_total_y[t,]))) {
# percent on ART female
P_Target_ART[t,y]<- Target_new[y,"P_ART_All_F"]
if (is.na(P_Target_ART[t,y])||is.na(On_ART_p_F_y[t,y]))
{
pd_art_p_F[t] <- pd_art_p_F[t]
} else {
pd_art_p_F[t] <- pd_art_p_F[t]+abs(On_ART_p_F_y[t,y]-P_Target_ART[t,y])/ (P_Target_ART[t,y])
}
}
# Percent on ART male
Diagnosed_M_total_y[t,] <- Diagnosed_M_total[t,1,][seq(1, length(Diagnosed_M_total[t,1,]), 12)]
On_ART_p_M_y[t,] <- On_ART_total_M[t,1,][seq(1,length(On_ART_total_M[t,1,]),12)]/Diagnosed_M_total_y[t,]*100
for (y in (1:length(P_suppressed_total_y[t,]))) {
# percent on ART male
P_Target_ART[t,y]<- Target_new[y,"P_ART_All_M"]
if (is.na(P_Target_ART[t,y])||is.na(On_ART_p_M_y[t,y]))
{
pd_art_p_M[t] <- pd_art_p_M[t]
} else {
pd_art_p_M[t] <- pd_art_p_M[t]+abs(On_ART_p_M_y[t,y]-P_Target_ART[t,y])/ (P_Target_ART[t,y])
}
}
# Percent viral suppression (among ART)
On_ART_total_y[t,] <- On_ART_total[t,1,][seq(1,length(On_ART_total[t,1,]),12)]
Suppressed_total_y[t,] <- Suppressed_total[t,1,][seq(1,length(Suppressed_total[t,1,]),12)]
P_suppressed_art_total_y[t,] <- Suppressed_total_y[t,]/On_ART_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among linked
Target_VS_art[t,y]<- Target_all[y,"Percent_VS_on_ART_total"]
if (is.na(Target_VS_art[t,y])||is.na(P_suppressed_art_total_y[t,y]))
{
pd_vs_ART_total[t] <- pd_vs_ART_total[t]
} else {
pd_vs_ART_total[t] <- pd_vs_ART_total[t]+abs(P_suppressed_art_total_y[t,y]-Target_VS_art[t,y])/ (Target_VS_art[t,y])
}
}
# Percent viral suppression female (among ART)
On_ART_total_F_y[t,] <- On_ART_total_F[t,1,][seq(1,length(On_ART_total_F[t,1,]),12)]
Suppressed_total_F_y[t,] <- Suppressed_total_F[t,1,][seq(1,length(Suppressed_total_F[t,1,]),12)]
P_suppressed_art_F_total_y[t,] <- Suppressed_total_F_y[t,]/On_ART_total_F_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among linked females
Target_VS_art_F[t,y]<- Target_all[y,"Percent_VS_on_ART_Female"]
if (is.na(Target_VS_art_F[t,y])||is.na(P_suppressed_art_F_total_y[t,y]))
{
pd_vs_ART_total_F[t] <- pd_vs_ART_total_F[t]
} else {
pd_vs_ART_total_F[t] <- pd_vs_ART_total_F[t]+abs(P_suppressed_art_F_total_y[t,y]-Target_VS_art_F[t,y])/ (Target_VS_art_F[t,y])
}
}
# Percent viral suppression male (among ART)
On_ART_total_M_y[t,] <- On_ART_total_M[t,1,][seq(1,length(On_ART_total_M[t,1,]),12)]
Suppressed_total_M_y[t,] <- Suppressed_total_M[t,1,][seq(1,length(Suppressed_total_M[t,1,]),12)]
P_suppressed_art_M_total_y[t,] <- Suppressed_total_M_y[t,]/On_ART_total_M_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among linked males
Target_VS_art_M[t,y]<- Target_all[y,"Percent_VS_on_ART_Male"]
if (is.na(Target_VS_art_M[t,y])||is.na(P_suppressed_art_M_total_y[t,y]))
{
pd_vs_ART_total_M[t] <- pd_vs_ART_total_M[t]
} else {
pd_vs_ART_total_M[t] <- pd_vs_ART_total_M[t]+abs(P_suppressed_art_M_total_y[t,y]-Target_VS_art_M[t,y])/ (Target_VS_art_M[t,y])
}
}
# Percent viral suppression (among ALL)
Suppressed_total_y[t,] <- Suppressed_total[t,1,][seq(1,length(Suppressed_total[t,1,]),12)]
P_suppressed_total_y[t,] <- Suppressed_total_y[t,]/N_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS linked
Target_VS[t,y]<- Target_all[y,"Percent_VS_total"]
if (is.na(Target_VS[t,y])||is.na(P_suppressed_total_y[t,y]))
{
pd_vs_total[t] <- pd_vs_total[t]
} else {
pd_vs_total[t] <- pd_vs_total[t]+abs(P_suppressed_total_y[t,y]-Target_VS[t,y])/ (Target_VS[t,y])
}
}
# Percent viral suppression female
Suppressed_total_F_y[t,] <- Suppressed_total_F[t,1,][seq(1,length(Suppressed_total_F[t,1,]),12)]
P_suppressed_F_total_y[t,] <- Suppressed_total_F_y[t,]/N_F_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among females
Target_VS_F[t,y]<- Target_all[y,"Percent_VS_Female"]
if (is.na(Target_VS_F[t,y])||is.na(P_suppressed_F_total_y[t,y]))
{
pd_vs_total_F[t] <- pd_vs_total_F[t]
} else {
pd_vs_total_F[t] <- pd_vs_total_F[t]+abs(P_suppressed_F_total_y[t,y]-Target_VS_F[t,y])/ (Target_VS_F[t,y])
}
}
# Percent viral suppression male
Suppressed_total_M_y[t,] <- Suppressed_total_M[t,1,][seq(1,length(Suppressed_total_M[t,1,]),12)]
P_suppressed_M_total_y[t,] <- Suppressed_total_M_y[t,]/N_M_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among males
Target_VS_M[t,y]<- Target_all[y,"Percent_VS_Male"]
if (is.na(Target_VS_M[t,y])||is.na(P_suppressed_M_total_y[t,y]))
{
pd_vs_total_M[t] <- pd_vs_total_M[t]
} else {
pd_vs_total_M[t] <- pd_vs_total_M[t]+abs(P_suppressed_M_total_y[t,y]-Target_VS_M[t,y])/ (Target_VS_M[t,y])
}
}
N_total_y[t,] <- N_total_all[t,1,][seq(1, length(N_total_all[t,1,]), 12)]
Suppressed_total_y[t,] <- Suppressed_total_all[t,1,][seq(1,length(Suppressed_total_all[t,1,]),12)]
P_suppressed_total_y[t,] <- Suppressed_total_y[t,]/N_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS linked
Target_VS[t,y]<- Target_new[y,"Percent_VS_total"]
if (is.na(Target_VS[t,y])||is.na(P_suppressed_total_y[t,y]))
{
pd_vs_total_all[t] <- pd_vs_total_all[t]
} else {
pd_vs_total_all[t] <- pd_vs_total_all[t]+abs(P_suppressed_total_y[t,y]-Target_VS[t,y])/ (Target_VS[t,y])
}
}
N_F_total_y[t,] <- N_F_total_all[t,1,][seq(1, length(N_F_total_all[t,1,]), 12)]
Suppressed_total_F_y[t,] <- Suppressed_total_F_all[t,1,][seq(1,length(Suppressed_total_F_all[t,1,]),12)]
P_suppressed_F_total_y[t,] <- Suppressed_total_F_y[t,]/N_F_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among females
Target_VS_F[t,y]<- Target_new[y,"Percent_VS_Female"]
if (is.na(Target_VS_F[t,y])||is.na(P_suppressed_F_total_y[t,y]))
{
pd_vs_total_F_all[t] <- pd_vs_total_F_all[t]
} else {
pd_vs_total_F_all[t] <- pd_vs_total_F_all[t]+abs(P_suppressed_F_total_y[t,y]-Target_VS_F[t,y])/ (Target_VS_F[t,y])
}
}
N_M_total_y[t,] <- N_M_total_all[t,1,][seq(1, length(N_M_total_all[t,1,]), 12)]
Suppressed_total_M_y[t,] <- Suppressed_total_M_all[t,1,][seq(1,length(Suppressed_total_M_all[t,1,]),12)]
P_suppressed_M_total_y[t,] <- Suppressed_total_M_y[t,]/N_M_total_y[t,]*100
for (y in (1:length(P_suppressed_art_total_y[t,]))) {
# % VS among males
Target_VS_M[t,y]<- Target_new[y,"Percent_VS_Male"]
if (is.na(Target_VS_M[t,y])||is.na(P_suppressed_M_total_y[t,y]))
{
pd_vs_total_M_all[t] <- pd_vs_total_M_all[t]
} else {
pd_vs_total_M_all[t] <- pd_vs_total_M_all[t]+abs(P_suppressed_M_total_y[t,y]-Target_VS_M[t,y])/ (Target_VS_M[t,y])
}
}
pd_total[t]= pd_n_art_total[t]+
pd_art_p[t] + pd_art_p_F[t] + pd_art_p_M[t]+
pd_vs_total[t] + pd_vs_total_F[t] + pd_vs_total_M[t] +
pd_vs_ART_total[t] + pd_vs_ART_total_F[t] + pd_vs_ART_total_M[t] +
pd_prev_total[t] + pd_prev_total_F[t] + pd_prev_total_M[t] +
pd_incidence_total[t]+pd_incidence_F_total[t]+pd_incidence_M_total[t]+
pd_prev_total_all[t] + pd_prev_total_F_all[t] + pd_prev_total_M_all[t]+
pd_vs_total_all[t] + pd_vs_total_F_all[t] + pd_vs_total_M_all[t]+
pd_prev_total_F_young[t] + pd_prev_total_M_young[t]
}
pdf(file="Calibration_top50_15-45_0506.pdf")
# Assign a vector to store the year variables
year <- seq(from=2004, to=2030, by=1)
for (t in 1:trials){
Prevalence_total[t, ] <- N_total/(N_total+S_total)
Prevalence_total_y[t,] <- Prevalence_total[t, seq(1,length(Prevalence_total[t,1,]),12)]}
for (t in 1:trial_select){
Prevalence_total[t, ] <- N_total/(N_total+S_total)
Prevalence_total_y[t,] <- Prevalence_total[t, seq(1,length(Prevalence_total[t,1,]),12)]}
for (t in 1:trials){
Prevalence_total[t,1,] <- (N_total[t,1,])/(N_total[t,1,]+S_total[t,1,])
Prevalence_total_y[t,] <- Prevalence_total[t,1,][seq(1,length(Prevalence_total[t,1,]),12)]*100}
for (t in 1:trials){
Prevalence_F_total[t,1,] <- (N_F_total[t,1,])/(N_F_total[t,1,]+S_F_total[t,1,])
Prevalence_F_total_y[t,] <- Prevalence_F_total[t,1,][seq(1,length(Prevalence_F_total[t,1,]),12)]*100}
setwd("C:/Users/exper/Desktop/Models/RW")
rm(list=ls())
load("pd_outcomes.RData")
load("outcomes.RData")
combined_outcome$generations = combined_outcome$row%%384
combined_outcome$generations[combined_outcome$generations==0] = 384
Target_all <- read.csv("Targets_00_15-54_new.csv")
Target_new <- read.csv("Targets_01.csv")
library(matrixStats)
library(gridExtra)
library(ggplot2)
library(ggpubr)
library(ragg)
install.packages("ragg")
library(ragg)
library(data.table)
install.packages("data.table")
library(data.table)
year <- seq(from=2004, to=2020, by=1)
color=c("Projected outcomes"="blue","PHIA targets"="red","DHS targets"="purple")
color2=c("Projected outcomes"="blue","UNAIDS targets"="red")
color3=c("Projected outcomes"="blue","Rwanda HMIS targets"="red")
Prevalence <- c("trial", "generations", "N_total", "S_total")
Outcome_prev <- combined_outcome[Prevalence]
Outcome_prev$Prevalence_total = Outcome_prev$N_total/(Outcome_prev$N_total+Outcome_prev$S_total)*100
# HIV prevalence female
Prevalence_F <- c("trial", "generations", "N_F_total", "S_F_total")
Outcome_prev <- combined_outcome[Prevalence_F]
# HIV incidence female
Incidence <- c("trial", "generations", "NI_F_total", "S_F_total")
Outcome_inc <- combined_outcome[Incidence]
Diagnose <- c("trial", "generations", "Diagnosed_F_total", "N_F_total")
Diagnose <- combined_outcome[Diagnose]
